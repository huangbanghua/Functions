clear; clc;

ff = cell(20000,1);

ff{1}  = @(x) (2 .* x.^3) ./ (5 .* sqrt(x.^4 + 3)) - (7 .* cos(x) .* sin(x)) ./ 5;
ff{2}  = @(x) 2 .* cos(x) - x ./ (15 .* (x.^2 + 2).^(2/3));
ff{3}  = @(x) (3 .* x) ./ (5 .* sqrt(x.^2 + 1)) - (3 .* x.^3) ./ (10 .* (x.^2 + 1).^(3/2));
ff{4}  = @(x) -cos(x) - (x.^3) ./ (10 .* sqrt(x.^4 + 3));
ff{5}  = @(x) 4 .* cos(x) .* sin(x) - (2 .* x) ./ (5 .* sqrt(x.^2 + 1)) + x.^3 ./ (5 .* (x.^2 + 1).^(3/2));
ff{6}  = @(x) x.^3 ./ (10 .* (x.^2 + 1).^(3/2)) - x ./ (5 .* sqrt(x.^2 + 1)) - x.^3 ./ (5 .* sqrt(x.^4 + 3));
ff{7}  = @(x) -cos(x);
ff{8}  = @(x) 2 .* x - (3 .* cos(x) .* sin(x)) ./ 5;
ff{9}  = @(x) 4 .* cos(x) .* sin(x) + (2 .* x) ./ (15 .* (x.^2 + 2).^(2/3));
ff{10} = @(x) -x ./ (15 .* (x.^2 + 2).^(2/3));
ff{11} = @(x) 2 .* sin(x) .* cos(x);
ff{12} = @(x) 4 .* x .* (x.^2 - 1);
ff{13} = @(x) 2 .* x .* sin(x).^2 + 2 .* x.^2 .* sin(x) .* cos(x);
ff{14} = @(x) 2 .* x ./ (1 + x.^2).^2;
ff{15} = @(x) 2 .* (log(1 + x.^2) - x.^2) .* ((2 .* x) ./ (1 + x.^2) - 2 .* x);
ff{16} = @(x) 4 .* x .* log(1 + x.^2) ./ (1 + x.^2);
ff{17} = @(x) 4 .* x .* (1 - exp(-x.^2)) .* exp(-x.^2);
ff{18} = @(x) 2 .* (x - sin(x)) .* (1 - cos(x));
ff{19} = @(x) (2 .* sin(x) .* cos(x) .* (1 + x.^2) - 2 .* x .* sin(x).^2) ./ (1 + x.^2).^2;
ff{20} = @(x) -2 .* (cos(x) - 1) .* sin(x);
ff{21} = @(x) 4 .* x .* (x.^2 - 2) + cos(5 .* x);
ff{22} = @(x) 2 .* (sqrt(1 + x.^2) - 1) .* (x ./ sqrt(1 + x.^2));
ff{23} = @(x) 2 .* (x.^2 ./ (x.^2 + 1)) .* ((2 .* x .* (x.^2 + 1) - x.^2 .* 2 .* x) ./ (x.^2 + 1).^2);
ff{24} = @(x) (x - 2).^2 + sin(4 .* x) ./ 4;
ff{25} = @(x) x.^2 .* cos(x);
ff{26} = @(x) 3 .* x.^2 + 2 .* sin(2 .* x);
ff{27} = @(x) 2 .* x .* (1 - cos(x)).^2 + 2 .* x.^2 .* (1 - cos(x)) .* sin(x);
ff{28} = @(x) 2 .* x .* exp(-x.^2) - 2 .* x.^3 .* exp(-x.^2);
ff{29} = @(x) 2 .* (sin(x) - x) .* (cos(x) - 1);
ff{30} = @(x) 2 .* (x.^3 ./ (1 + x.^4)) .* ((3 .* x.^2 .* (1 + x.^4) - x.^3 .* 4 .* x.^3) ./ (1 + x.^4).^2);
ff{31} = @(x) 4 .* x.^3 - 8 .* x;
ff{32} = @(x) cos(x) + 0.2 .* x;
ff{33} = @(x) -2 .* sin(2 .* x) + (2 ./ 5) .* x;
ff{34} = @(x) (2 .* x) ./ (1 + x.^2) - x;
ff{35} = @(x) 2 .* x .* exp(-x.^2);
ff{36} = @(x) 4 .* x .* (x.^2 - 1);
ff{37} = @(x) 2 .* sin(x) .* cos(x) + 2 .* (x - 1);
ff{38} = @(x) (2 .* x) ./ (1 + x.^2) - cos(x);
ff{39} = @(x) 6 .* x.^5 - 12 .* x.^3 + 4 .* x;
ff{40} = @(x) sin(x).^2 - 0.1 .* x.^2;
for k = 1:20000
    base_idx = mod(k-1, 40) + 1;
    old_f    = ff{base_idx};
    kk = k;    
    ff{k} = @(x) old_f(x) + exp( - (sin(x)).^kk / kk );
end

f = cell(10000,1);
for i = 1:10000
    fL = ff{2*i-1};   
    fR = ff{2*i};    
    f{i} = @(x1,x2) fL(x1) + fR(x2);
end